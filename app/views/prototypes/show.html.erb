<main class="main">
  <div class="inner">
    <div class="prototype__wrapper">
      <% if @prototype.present? %>
        <p class="prototype__hedding">
          <%= @prototype.title %>
        </p>
        <% if @prototype.user.present? %>
          <%= link_to "by #{current_user.name}", user_path(@prototype.user), class: :prototype__user %>
        <% end %>

        <% if user_signed_in? && current_user.id == @prototype.user_id %>
          <div class="prototype__manage">
            <%= link_to "編集する", edit_prototype_path(@prototype.id), method: :get, class: :prototype__btn %>
            <%= link_to "削除する", prototype_path(@prototype.id), method: :delete, class: :prototype__btn %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</main>

<% if @prototype.present? && @prototype.image.attached? %>
  <div class="prototype__image">
    <%= image_tag(@prototype.image, class: :card__img) %>
  </div>
<% end %>

<div class="prototype__body">
  <div class="prototype__detail">
    <p class="detail__title">キャッチコピー</p>
    <p class="detail__message">
      <%= @prototype.catch_copy if @prototype.present? %>
    </p>
  </div>

  <% if @prototype.present? %>
    <div class="prototype__detail">
      <p class="detail__title">コンセプト</p>
      <p class="detail__message">
        <%= @prototype.concept %>
      </p>
    </div>
  <% end %>
</div>

<div class="prototype__comments">
  <% if @prototype.present? && user_signed_in? && current_user.id == @prototype.user_id %>
    <%= form_with(model: [@prototype, @comment], local: true) do |f| %>
      <div class="field">
        <%= f.label :comment_content, "コメント" %><br />
        <%= f.text_field :comment_content, id: "comment_content" %><br />
      </div>
      <div class="actions">
        <%= f.submit "送信する", class: :form__btn %><br />
      </div>
    <% end %>
  <% end %>

  <div class="comments">
      <% @comments.each do |comment| %>
        <p>
          <strong><%= link_to comment.user.name, "/users/#{@comment.user_id}" %>:</strong>
        </p>
      <% end %>
    </div>

  <ul class="comments_lists">
      <% if @prototype.present? %>
        <% @prototype.comments.each do |comment| %>
          <li class="comments_list">
            <%= " コメントのテキスト " %>
            <% if comment.user.present? %>
              <%= link_to comment.user.name, user_path(comment.user), class: :comment_user %>
            <% else %>
              <%= "Unknown User" %>
            <% end %>
          </li>
        <% end %>
      <% else %>
        <%= "Prototype not found" %>
      <% end %>
    </ul>
  </div>
</div>